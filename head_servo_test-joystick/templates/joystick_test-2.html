<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <title>Joystick Event Test File</title>

  </head>

  <body>

    <div class="container">
        <div class="robot">
            Joystick Test File - Second Try
            <ul>
                <li id="state">State: Stop</li>
                <li id="angle_deg">Angle Degrees: 1.00Â°</li>
                <li id="angle_dir">Angle Direction: none</li>
                <li id="force">Joystick Force: 1.00</li>
                <li id="status">Joystick Status: Not Set</li>
                <li id="index">Joystick Index: 1.00</li>
                <li id="id">Joystick ID: Not Set</li>
                <li id="num_buttons">Number of Joystick Buttons: 1.00</li>
                <li id="num_axes">Number of Joystick Axes: 1.00</li>
                <li id="axis0">Value of Axis 1: 1.00</li>
                <li id="axis1">Value of Axis 1: 1.00</li>
                <li id="axis2">Value of Axis 2: 1.00</li>
                <li id="axis3">Value of Axis 3: 1.00</li>
                <li id="axis4">Value of Axis 4: 1.00</li>
            </ul>
        </div>
    </div>

    <p id="demo"></p>

<script>
// All the Javascript stuff goes here
//
var joystick_data

// Implement a "sleep" function
const sleep = (milliseconds) => {
return new Promise(resolve => setTimeout(resolve, milliseconds))
}

window.addEventListener("gamepadconnected", (event) => {
  joystick_data = event.gamepad;
    console.log("A gamepad was connected:");
    console.log("joystick_data");
    console.log(joystick_data);
    console.log("joystick.data.id");
    console.log(joystick_data.id);
    console.log("joystick_data.buttons");
    console.log(joystick_data.buttons);
    console.log("joystick_data.buttons - joystick_data.buttons[23]");
    console.log(joystick_data.buttons, " - ", joystick_data.buttons[23]);
    get_gamepad_data();
//    get_data();
});

window.addEventListener("gamepaddisconnected", (event) => {
  console.log("A gamepad was disconnected:");
  console.log(event.gamepad);
});

function  get_gamepad_data() {
  var js = (navigator.getGamepads && navigator.getGamepads()) || (navigator.webkitGetGamepads && navigator.webkitGetGamepads());
  console.log("\nthe 'navigator.getGamepads()' (js) value is:");
  console.log(js);
  // data from web-site
  console.log("js[0]");
  console.log(js[0]);
  // Steering:
  console.log("\njs[0].axes[0]");
  console.log(js[0].axes[0]);
  // Acceleration:
  console.log("js[0].axes[1]");
  console.log(js[0].axes[1]);
  // Breaking:
  console.log("js[0].axes[2]");
  console.log(js[0].axes[2]);
  // Buttons from 0 - 33:
  console.log("js[0].buttons");
  console.log(js[0].buttons);
return;
}

function get_data() {
  while (true) {
    sleep(1000).then(() => {
      get_gamepad_data;
    })
  }
}
 </script>
